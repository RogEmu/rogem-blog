/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

var v=Object.defineProperty;var M=Object.getOwnPropertyDescriptor;var A=Object.getOwnPropertyNames;var _=Object.prototype.hasOwnProperty;var $=(s,r)=>{for(var e in r)v(s,e,{get:r[e],enumerable:!0})},J=(s,r,e,t)=>{if(r&&typeof r=="object"||typeof r=="function")for(let a of A(r))!_.call(s,a)&&a!==e&&v(s,a,{get:()=>r[a],enumerable:!(t=M(r,a))||t.enumerable});return s};var Y=s=>J(v({},"__esModule",{value:!0}),s);var z={};$(z,{default:()=>T});module.exports=Y(z);var D=require("obsidian");var o=require("obsidian"),d={postsFolder:"_posts",draftsFolder:"_drafts",templateFolder:"",templateFile:"",dateTimeFormat:"YYYY-MM-DD HH:mm ZZ"},x=class extends o.AbstractInputSuggest{constructor(e,t,a,i){super(e,t);this.onSubmit=i,this.targetFolderPath=a}getSuggestions(e){let t=this.app.vault.getFolderByPath((0,o.normalizePath)(this.targetFolderPath));return t?t.children.filter(a=>a.name.toLowerCase().includes(e.toLowerCase())):[]}renderSuggestion(e,t){t.createEl("div",{text:e.name})}selectSuggestion(e,t){this.onSubmit(e),new o.Notice(`Selected file: ${e.path}`),this.close()}},y=class extends o.AbstractInputSuggest{constructor(e,t,a){super(e,t);this.onSubmit=a}getSuggestions(e){return this.app.vault.getAllFolders().filter(t=>t.name.includes(e))}renderSuggestion(e,t){t.createEl("div",{text:e.name})}selectSuggestion(e,t){new o.Notice(`Selected folder: ${e.path}`),this.onSubmit(e),this.close()}},F=class extends o.PluginSettingTab{constructor(e,t){super(e,t);this.plugin=t}display(){let{containerEl:e}=this;e.empty(),e.createEl("h2",{text:"Jekyll Compose Settings"}),new o.Setting(e).setName("Posts Folder").setDesc("Folder where Jekyll posts will be created.").addText(t=>t.setPlaceholder(d.postsFolder).setValue(this.plugin.settings.postsFolder).onChange(async a=>{this.plugin.settings.postsFolder=a.trim(),await this.plugin.saveSettings()})),new o.Setting(e).setName("Drafts Folder").setDesc("Folder where Jekyll drafts will be created.").addText(t=>t.setPlaceholder(d.draftsFolder).setValue(this.plugin.settings.draftsFolder).onChange(async a=>{this.plugin.settings.draftsFolder=a.trim(),await this.plugin.saveSettings()})),new o.Setting(e).setName("Default Template File").setDesc("Filepath to a markdown file to use as a template for new posts and drafts. Leave empty for no template.").addText(t=>{t.setPlaceholder(d.templateFile).setValue(this.plugin.settings.templateFile).onChange(async a=>{this.plugin.settings.templateFile=a.trim(),await this.plugin.saveSettings()}),new x(this.app,t.inputEl,this.plugin.settings.templateFolder,a=>{t.setValue(a.path),this.plugin.settings.templateFile=a.path})}),new o.Setting(e).setName("Default Template Folder").setDesc("Folder to select template files from when choosing a template for new posts and drafts.").addText(t=>{t.setPlaceholder(d.templateFolder).setValue(this.plugin.settings.templateFolder).onChange(async a=>{this.plugin.settings.templateFolder=a.trim(),await this.plugin.saveSettings()}),new y(this.app,t.inputEl,a=>{t.setValue(a.path),t.onChanged(),this.display()})}),new o.Setting(e).setName("Default Date-Time Format").setDesc("Default format for date-time in Jekyll front matter.").addText(t=>{t.setPlaceholder(d.dateTimeFormat).setValue(this.plugin.settings.dateTimeFormat).onChange(async a=>{this.plugin.settings.dateTimeFormat=a.trim(),await this.plugin.saveSettings()})})}};var l=require("obsidian");var c=require("obsidian"),p=class extends c.SuggestModal{constructor(e,t,a,i){super(e);this.setPlaceholder(t),this.emptyText=a,this.onSubmit=i,this.setInstructions([{command:"\u21B5",purpose:"to create"},{command:"esc",purpose:"to dismiss"}])}getSuggestions(e){let t=e.trim();return t?[t]:[]}renderSuggestion(e,t){let a=t.createEl("div",{cls:"modal-suggestion-item"});a.createEl("div",{text:e}),a.createEl("small",{text:"Enter to create",cls:"modal-suggestion-hotkey"})}onNoSuggestion(){this.resultContainerEl.empty()}onChooseSuggestion(e,t){if(!e.trim()){new c.Notice("Please enter a title");return}this.onSubmit(e.trim())}selectSuggestion(e,t){var i,n;if(!((n=(i=this.inputEl)==null?void 0:i.value)==null?void 0:n.trim())){new c.Notice("Please enter a title"),this.close();return}super.selectSuggestion(e,t)}},g=class extends c.SuggestModal{constructor(e,t,a){super(e);this.targetFolder=e.vault.getFolderByPath((0,c.normalizePath)(t)),this.onSubmit=a,this.setInstructions([{command:"\u21B5",purpose:"to select"},{command:"esc",purpose:"to dismiss"}])}getSuggestions(e){return this.targetFolder?this.targetFolder.children.filter(t=>t.name.toLowerCase().includes(e.toLowerCase())):[]}renderSuggestion(e,t){t.createEl("div",{cls:"modal-suggestion-item"}).createEl("div",{text:e.name})}onChooseSuggestion(e,t){this.onSubmit(e)}};var N=/([\p{Ll}\d])(\p{Lu})/gu,R=/(\p{Lu})([\p{Lu}][\p{Ll}])/gu,I=/(\d)\p{Ll}|(\p{L})\d/u,U=/[^\p{L}\d]+/giu,E="$1\0$2",C="";function S(s){let r=s.trim();r=r.replace(N,E).replace(R,E),r=r.replace(U,"\0");let e=0,t=r.length;for(;r.charAt(e)==="\0";)e++;if(e===t)return[];for(;r.charAt(t-1)==="\0";)t--;return r.slice(e,t).split(/\0/g)}function H(s){var e;let r=S(s);for(let t=0;t<r.length;t++){let a=r[t],i=I.exec(a);if(i){let n=i.index+((e=i[1])!=null?e:i[2]).length;r.splice(t,1,a.slice(0,n),a.slice(n))}}return r}function j(s,r){var i;let[e,t,a]=Z(s,r);return e+t.map(V(r==null?void 0:r.locale)).join((i=r==null?void 0:r.delimiter)!=null?i:" ")+a}function P(s,r){return j(s,{delimiter:"-",...r})}function V(s){return s===!1?r=>r.toLowerCase():r=>r.toLocaleLowerCase(s)}function Z(s,r={}){var m,u,h;let e=(m=r.split)!=null?m:r.separateNumbers?H:S,t=(u=r.prefixCharacters)!=null?u:C,a=(h=r.suffixCharacters)!=null?h:C,i=0,n=s.length;for(;i<s.length;){let f=s.charAt(i);if(!t.includes(f))break;i++}for(;n>i;){let f=n-1,L=s.charAt(f);if(!a.includes(L))break;n=f}return[s.slice(0,i),e(s.slice(i,n)),s.slice(n)]}var b=require("obsidian");function k(){return{layout:"post",title:"",date:(0,b.moment)().format("YYYY-MM-DD HH:mm ZZ"),categories:[],tags:[]}}var w=class{constructor(r){this.app=r}addCommands(r){r.addCommand({id:"create-jekyll-draft",name:"Create draft",callback:()=>{new p(r.app,"Enter title","Title cannot be empty",e=>{this.createJekyllDraft(e,r.settings.draftsFolder)}).open()}}),r.addCommand({id:"create-jekyll-post",name:"Create post",callback:()=>{new p(r.app,"Enter title","Title cannot be empty",e=>{this.createJekyllPost(e,r.settings.postsFolder)}).open()}}),r.addCommand({id:"publish-jekyll-draft",name:"Publish draft",callback:()=>{new g(r.app,r.settings.draftsFolder,e=>{this.publishJekyllDraft(e,r.settings.postsFolder).then(()=>{new l.Notice(`Draft "${e.basename}" has been published`)}).catch(t=>{new l.Notice(`Error publishing draft: ${t.message}`)})}).open()}}),r.addCommand({id:"unpublish-jekyll-post",name:"Unpublish post",callback:()=>{new g(r.app,r.settings.postsFolder,e=>{this.unpublishJekyllPost(e,r.settings.draftsFolder).then(()=>{new l.Notice(`Post "${e.basename}" has been unpublished`)}).catch(t=>{new l.Notice(`Error unpublishing post: ${t.message}`)})}).open()}})}async createJekyllDraft(r,e){try{await this.createJekyllFile(r,e),new l.Notice(`Draft "${r}" created`)}catch(t){new l.Notice(`Error creating draft: ${t.message}`)}}async createJekyllPost(r,e){try{let t=(0,l.moment)().format("YYYY-MM-DD");await this.createJekyllFile(r,e,t),new l.Notice(`Post "${r}" created`)}catch(t){new l.Notice(`Error creating post: ${t.message}`)}}async createJekyllFile(r,e,t){let a=P(r.trim());t&&(a=`${t}-${a}`);let i=(0,l.normalizePath)(e),n=(0,l.normalizePath)(`${i}/${a}.md`);if(await this.ensureFolderExists(i),await this.app.vault.adapter.exists(n))throw new Error(`"${a}" already exists`);let m=await this.app.vault.create(n,"");return await this.app.workspace.getLeaf(!1).openFile(m),await this.app.fileManager.processFrontMatter(m,u=>{let h=k();Object.assign(u,h),u.title=r.trim()}),m}async ensureFolderExists(r){let e=(0,l.normalizePath)(r);await this.app.vault.adapter.exists(e)||await this.app.vault.createFolder(e)}async publishJekyllDraft(r,e){let t=(0,l.normalizePath)(e);await this.ensureFolderExists(t);let a=(0,l.moment)().format("YYYY-MM-DD")+`-${r.name}`,i=(0,l.normalizePath)(`${t}/${a}`);if(await this.app.vault.adapter.exists(i))throw new Error(`A post with the name "${a}" already exists`);await this.app.vault.rename(r,i),await this.app.fileManager.processFrontMatter(r,n=>{n.date=(0,l.moment)().format("YYYY-MM-DD HH:mm ZZ")})}async unpublishJekyllPost(r,e){let t=(0,l.normalizePath)(e);await this.ensureFolderExists(t);let a=r.name.replace(/^\d{4}-\d{2}-\d{2}-/,""),i=(0,l.normalizePath)(`${t}/${a}`);if(await this.app.vault.adapter.exists(i))throw new Error(`Draft "${a}" already exists`);await this.app.vault.rename(r,i)}};var T=class extends D.Plugin{async onload(){await this.loadSettings(),this.commands=new w(this.app),this.commands.addCommands(this),this.addSettingTab(new F(this.app,this))}onunload(){}async loadSettings(){this.settings=Object.assign({},d,await this.loadData())}async saveSettings(){await this.saveData(this.settings)}};
